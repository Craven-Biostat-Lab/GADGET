{% extends "base.html" %}

{% block title %}GADGET{% if q or genes %}: genes for{% if q %} {{ q|safe }}{% endif %}{% if q and genesyms %} and{% endif %}{% if genesyms %} {{ genesyms|join:', ' }}{% endif %}{% endif %}{% endblock %}

{% block head %}
{% if q or genes %}
<script type="text/javascript">
    var q = "{{ q|urlencode }}";
    var genes = "{{ genes|join:','|urlencode }}";
    var genesyms = "{{ genesyms|join:', '|urlencode }}";
    var species = "{{ species|urlencode }}";
    var usehomologs = "{{ usehomologs|urlencode }}";
    var orderby = "{{ orderby|urlencode }}";
</script>
<script type="text/javascript" src="/static/genesearch.js"></script>
{% endif %}
{% if errormsg %}
<script type="text/javascript">
$(document).ready(function()
{
    flash("{{ errormsg|escapejs }} ");
});
</script>
{% endif %}
{% endblock %}

{% block header %}
<a href="/"><img src="/static/logo-small.png" id="smalllogo" border="0" style="display:inline; float:left; padding-top:20px"/></a>
<form name="search" action="" method="get">
    <table>
        <tr>
            <td>{{ form.q.label }}: {{ form.q }}</td>
            <td>{{ form.genes.label }}: {{ form.genes }}</td>
            
            <td rowspan="2"><input type="submit" value="Search Genes" /></td>
        </tr>
        <tr>
            <td>{{ form.species.label }}: {{ form.species }}</td>
            <td style="text-align:left">{{ form.usehomologs.label }}: {{ form.usehomologs }}</td>
        </tr>
    </table>
</form>

<table id="download" style="display:none">
    <tr><td colspan="2">Download results:</td></tr>
    <tr>
        <td><a href="genelist?{% if q %}q={{ q|urlencode }}{% endif %}{% if genes %}&genes={{ genesyms|join:', '|urlencode }}{% endif %}{% if species %}&species={{ species|urlencode }}{% endif %}{% if usehomologs %}&usehomologs={{ usehomologs|urlencode }}{% endif %}{% if orderby %}&orderby={{ orderby|urlencode }}{% endif %}&download=csv">CSV</a></td>
        <td><a href="genelist?{% if q %}q={{ q|urlencode }}{% endif %}{% if genes %}&genes={{ genesyms|join:', '|urlencode }}{% endif %}{% if species %}&species={{ species|urlencode }}{% endif %}{% if usehomologs %}&usehomologs={{ usehomologs|urlencode }}{% endif %}{% if orderby %}&orderby={{ orderby|urlencode }}{% endif %}&download=xml" target="_blank">XML</a></td>
    </tr>
</table>
{% endblock %}

{% block content %}
<div id="description" style="display:none">
    Showing and scoring genes in abstracts{% if q %} matching <b>{{ q|safe }}</b>{% endif %}{% if q and genesyms %} and{% endif %}{% if genesyms %} containing genes <b>{{ genesyms|join:', ' }}</b>{% endif %}<br />
    For species <b>{{ speciesname }}</b>,<b>{% if not usehomologs %} not{% endif %} using homologs</b><br /><br />
    <a href="eventsearch?{% if q %}q={{ q|urlencode }}{% endif %}{% if genesyms %}&genes={{ genesyms|join:','|urlencode }}{% endif %}">See interactions{% if genesyms %} for genes <b>{{ genesyms|join:',' }}</b>{% endif %}{% if q %} in abstracts matching <b>{{ q|safe }}</b>{% endif %}</a>
</div><br />
<div id="results" style="display:none">
    <a class="hint" target="_blank" href="/manual.html#genesearch">About gene search results</a>
    <a class="hint" target="_blank" href="/manual.html#scores">Gene search scores</a>
    <table class="stripe" id="generank">
        <tr>
            <th></th>
            <th>Rank</th>
            <th>{% if orderby == 'f1_score' %}<u>F1 Score</u>{% else %}<a href="javascript:order('f1_score');">F1 Score</a>{% endif %}</th>
            <th>{% if orderby == 'matching_abstracts' %}<u>Matching Abstracts</u>{% else %}<a href="javascript:order('matching_abstracts');">Matching Abstracts</a>{% endif %}</th>
            <th>{% if orderby == 'total_abstracts' %}<u>Total Abstracts</u>{% else %}<a href="javascript:order('total_abstracts');">Total Abstracts</a>{% endif %}</th>
            <th>{% if orderby == 'adjusted_precision' %}<u>Adjusted Precision</u>{% else %}<a href="javascript:order('adjusted_precision');">Adjusted Precision</a>{% endif %}</th>
            <th>p value</th>
            <th>Symbol</th>
            <th>Name</th>
            <th>Entrez ID</th>
            <th>Synonyms</th>
            <th>Map Location</th>
        </tr>
    </table>
</div>
<input type="button" id="more" value="More..." style="display:none" />
{% endblock %}
